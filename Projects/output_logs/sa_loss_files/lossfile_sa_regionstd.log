Meshed-Memory Transformer Training
loading files: done!!!
Load vocabulary: done!!
building model: done !!
establish training dataset: done !!
establish evaluation dataset: done !!
-----Training starts-----
----------Epoch0----------
Eproch -1: Val loss 12.678187688191732  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 12.67666029047083  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 6.060975480962683  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 4.910753232461435  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 0: Val loss 4.694619549645318  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 0: Training loss2 4.746218433105406  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.29347224463078, 0.1387421154712749, 0.053240389166790136, 0.024528698296211564], 'METEOR': 0.0711922137592339, 'ROUGE': 0.22994208692641033, 'CIDEr': 0.02857705441311607}
Test scores {'BLEU': [0.28230149638439717, 0.13197084191187156, 0.05197601106863367, 0.024490116997519], 'METEOR': 0.06889911219198973, 'ROUGE': 0.22383387396483231, 'CIDEr': 0.026604064756538773}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch1----------
Eproch -1: Val loss 4.694619549645318  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 4.693397627936469  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 4.446403697684959  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 4.327562155546965  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 1: Val loss 4.282547120694761  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 1: Training loss2 4.318515595094658  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.2854740994572669, 0.13997604934958693, 0.05877555256053172, 0.02845212978259307], 'METEOR': 0.07223248150593663, 'ROUGE': 0.23129972674310265, 'CIDEr': 0.0301818214040397}
Test scores {'BLEU': [0.28005980172117617, 0.13811971408118404, 0.05874940424460032, 0.029364097132437532], 'METEOR': 0.07228460714196068, 'ROUGE': 0.22758796938725617, 'CIDEr': 0.03422313101131351}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch2----------
Eproch -1: Val loss 4.282547120694761  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 4.280179624204282  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 4.185559290426749  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 4.109845841372454  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 2: Val loss 4.075033055411445  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 2: Training loss2 4.094656938388024  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.2981204434562304, 0.1481994578330856, 0.06864304935212891, 0.03495635811489919], 'METEOR': 0.07897137929003115, 'ROUGE': 0.23219924532887765, 'CIDEr': 0.057636214582533166}
Test scores {'BLEU': [0.2922422796249505, 0.1417791234204137, 0.06457912386492483, 0.03225506700612283], 'METEOR': 0.07692103604892919, 'ROUGE': 0.22690038524492165, 'CIDEr': 0.06445845993877687}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch3----------
Eproch -1: Val loss 4.075033055411445  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 4.075731807284885  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 4.005944357977973  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.945417289380674  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 3: Val loss 3.9322914370784052  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 3: Training loss2 3.916055514979264  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.32362588607277604, 0.1697710561028611, 0.08418872974405005, 0.04561488041100947], 'METEOR': 0.08343503237243956, 'ROUGE': 0.24795859829807004, 'CIDEr': 0.07209775561207356}
Test scores {'BLEU': [0.3201642612751127, 0.1619319233059893, 0.07583687785008678, 0.03802673347606185], 'METEOR': 0.08347506844268271, 'ROUGE': 0.24594434855676764, 'CIDEr': 0.07105737139829434}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch4----------
Eproch -1: Val loss 3.9322914370784052  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.931196027331882  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.886506018815217  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.8367708877280906  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 4: Val loss 3.823784015796803  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 4: Training loss2 3.760253512810287  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.32186271145148354, 0.17036519298157277, 0.08405302844655006, 0.04451897012922266], 'METEOR': 0.08307062430720505, 'ROUGE': 0.24832511750720607, 'CIDEr': 0.08233232193485344}
Test scores {'BLEU': [0.3143655826063909, 0.1630190151426907, 0.07924843967285755, 0.04275193493049796], 'METEOR': 0.08467619799787195, 'ROUGE': 0.2431351618807327, 'CIDEr': 0.08228494902855543}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch5----------
Eproch -1: Val loss 3.823784015796803  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.8245944800200284  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.7866339330320007  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.756866375605265  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 5: Val loss 3.735682072462859  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 5: Training loss2 3.6228069734180908  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3208591247437879, 0.16757728893612917, 0.08225351886575176, 0.044734940340237776], 'METEOR': 0.08478226817381349, 'ROUGE': 0.25155352299482264, 'CIDEr': 0.07939365051547043}
Test scores {'BLEU': [0.3139575931351861, 0.16259591375427182, 0.07885061481306581, 0.042892794260070186], 'METEOR': 0.08401325523611944, 'ROUGE': 0.24655519710930818, 'CIDEr': 0.08504962234097292}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch6----------
Eproch -1: Val loss 3.735682072462859  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.7356437842051187  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.7207428525995323  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.6965072287453546  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 6: Val loss 3.68174147605896  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 6: Training loss2 3.5043797071087996  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3047233256261447, 0.1527752442378007, 0.07297325341196126, 0.038305884172622116], 'METEOR': 0.0791728272184853, 'ROUGE': 0.2421059669795901, 'CIDEr': 0.06372934781853572}
Test scores {'BLEU': [0.3011237513827941, 0.14950400023326849, 0.07190560278873145, 0.03956046171938551], 'METEOR': 0.07976295781791949, 'ROUGE': 0.23903579335047423, 'CIDEr': 0.07291562549659285}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch7----------
Eproch -1: Val loss 3.68174147605896  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.682501051161024  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.6851295541833946  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.656170950995551  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 7: Val loss 3.6385473940107556  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 7: Training loss2 3.387414282241476  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.2966407701006156, 0.14789949531685756, 0.07110268166174691, 0.03805573420213986], 'METEOR': 0.07660226002443991, 'ROUGE': 0.2363557957478857, 'CIDEr': 0.06406933486838032}
Test scores {'BLEU': [0.296288135825869, 0.14529634040318362, 0.06891607572746204, 0.036731925943720004], 'METEOR': 0.07737490273975513, 'ROUGE': 0.23430428523404143, 'CIDEr': 0.0661438819116415}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch8----------
Eproch -1: Val loss 3.6385473940107556  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.64599844261452  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.6376964118745594  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.6263940599229603  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 8: Val loss 3.627821763356527  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 8: Training loss2 3.2891970509854853  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.31244621175717924, 0.15988989953078508, 0.07966181313630578, 0.042150634143567546], 'METEOR': 0.08442653159343175, 'ROUGE': 0.24400833395021143, 'CIDEr': 0.08181841208317277}
Test scores {'BLEU': [0.30851000479119123, 0.15540235323757262, 0.07516691165556645, 0.04094434240700816], 'METEOR': 0.08268309619192082, 'ROUGE': 0.23906307574863933, 'CIDEr': 0.08238382075838929}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch9----------
Eproch -1: Val loss 3.627821763356527  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.6252669360902576  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.621658272213406  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.6026717910060175  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 9: Val loss 3.5982930660247803  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 9: Training loss2 3.177656235518279  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.31285860555455697, 0.1584598582161565, 0.07681921239735212, 0.041141630349363315], 'METEOR': 0.08301492687480978, 'ROUGE': 0.2456693437317097, 'CIDEr': 0.0792361999289407}
Test scores {'BLEU': [0.31009469853094757, 0.15345873093124626, 0.07503153552608084, 0.04241194880012911], 'METEOR': 0.08337019776372377, 'ROUGE': 0.23792550589187347, 'CIDEr': 0.08444137297215268}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch10----------
Eproch -1: Val loss 3.5982930660247803  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.598270054216738  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.589782984168441  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.5987867249382868  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 10: Val loss 3.5824461954611317  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 10: Training loss2 3.069046215265376  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3112772333323155, 0.15587818664858882, 0.07638495491103783, 0.041221978419908975], 'METEOR': 0.08272181511421575, 'ROUGE': 0.24087343653824334, 'CIDEr': 0.0895330965539789}
Test scores {'BLEU': [0.30447138146152003, 0.14896793617639598, 0.07263295643340044, 0.040483157994821745], 'METEOR': 0.08266004328664392, 'ROUGE': 0.23403885899605031, 'CIDEr': 0.0918721329072785}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch11----------
Eproch -1: Val loss 3.5824461954611317  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.585411681069268  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.5990147943849915  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.5954648388756647  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 11: Val loss 3.579733782344394  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 11: Training loss2 2.965392545908076  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3029664846489145, 0.14957275216559823, 0.0705889188210639, 0.037538805964824576], 'METEOR': 0.08135273895833767, 'ROUGE': 0.2396028329756439, 'CIDEr': 0.07408191923896383}
Test scores {'BLEU': [0.2973848290118472, 0.14532965320560803, 0.06940698793346775, 0.039141015893592895], 'METEOR': 0.08113096148741637, 'ROUGE': 0.23387698234426282, 'CIDEr': 0.07548107119948975}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch12----------
Eproch -1: Val loss 3.579733782344394  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.582570888378002  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.604411522547404  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.5944041455233537  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 12: Val loss 3.580579492780897  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 12: Training loss2 2.8655137608571306  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3162906177274858, 0.16577475882653703, 0.08482265436982053, 0.046825133920841484], 'METEOR': 0.08532467324828923, 'ROUGE': 0.24168892404547856, 'CIDEr': 0.09394333454656015}
Test scores {'BLEU': [0.307037247441045, 0.15404807379331312, 0.07703962040426279, 0.04417221266109362], 'METEOR': 0.08237769685488286, 'ROUGE': 0.23478554633967, 'CIDEr': 0.0944939737264608}
validation: done !
saved model: done !!!!
----------Epoch13----------
Eproch -1: Val loss 3.580579492780897  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.583916491932339  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.597513693350333  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.5853137793364347  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 13: Val loss 3.575220893930506  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 13: Training loss2 2.754569953851739  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3244935387636045, 0.1657457873999129, 0.08169669645853367, 0.04525550592167351], 'METEOR': 0.08689804468386503, 'ROUGE': 0.25028229111919714, 'CIDEr': 0.09051562132891847}
Test scores {'BLEU': [0.318282423473552, 0.1592923596965305, 0.07799968876199456, 0.044281982046924684], 'METEOR': 0.08491196356822077, 'ROUGE': 0.24129787476367542, 'CIDEr': 0.08872876593124145}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch14----------
Eproch -1: Val loss 3.575220893930506  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.579035922333046  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.5973734149226435  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.589248153898451  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 14: Val loss 3.590330468283759  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 14: Training loss2 2.655682376873346  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3262595193746886, 0.17001270458980056, 0.08209044607522241, 0.04320425771220256], 'METEOR': 0.08640857219814617, 'ROUGE': 0.2469318511298944, 'CIDEr': 0.08796019842773448}
Test scores {'BLEU': [0.3203071520065191, 0.16520644148324523, 0.08123205462719522, 0.046971152690432234], 'METEOR': 0.08618123338065262, 'ROUGE': 0.24466250467539, 'CIDEr': 0.09072620410955794}
validation: done !
saved model: done !!!!
----------Epoch15----------
Eproch -1: Val loss 3.590330468283759  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.591689533657498  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.625179891233091  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.6005443820246943  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 15: Val loss 3.591052673481129  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 15: Training loss2 2.555542607856876  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3126184063965546, 0.15959832290819775, 0.0776071018343137, 0.04126703862601705], 'METEOR': 0.08589773296670397, 'ROUGE': 0.24142077963142514, 'CIDEr': 0.0838928082830881}
Test scores {'BLEU': [0.30446552109451525, 0.1517447276518853, 0.07277684301717992, 0.0406929327402854], 'METEOR': 0.0831502984773096, 'ROUGE': 0.23143746308353624, 'CIDEr': 0.09404741845349857}
validation: done !
saved model: done !!!!
----------Epoch16----------
Eproch -1: Val loss 3.591052673481129  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.5941768708052457  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.630017704433865  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.604578455289205  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 16: Val loss 3.60190017135055  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 16: Training loss2 2.4731112630278975  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.31785658442500503, 0.15953589946174768, 0.0768086652157179, 0.040623757932486], 'METEOR': 0.08541438343532196, 'ROUGE': 0.2422174577489548, 'CIDEr': 0.09333715480714495}
Test scores {'BLEU': [0.311123423810904, 0.15581918662296285, 0.07587112273419648, 0.04220702627268752], 'METEOR': 0.08337348709610333, 'ROUGE': 0.23635350010642098, 'CIDEr': 0.09090399711568464}
validation: done !
saved model: done !!!!
----------Epoch17----------
Eproch -1: Val loss 3.60190017135055  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.60992043989676  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.6371013235162803  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.640879401454219  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 17: Val loss 3.6227787424016884  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 17: Training loss2 2.371113596629704  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3048230468031944, 0.15024061084037973, 0.07310180561685298, 0.03916218906734128], 'METEOR': 0.08292297123636444, 'ROUGE': 0.23044009315088707, 'CIDEr': 0.09436169383911965}
Test scores {'BLEU': [0.2998353728530462, 0.1468716489820476, 0.07456873559596515, 0.04307386701642498], 'METEOR': 0.08242227112688057, 'ROUGE': 0.2251958917282386, 'CIDEr': 0.10360548719242094}
validation: done !
saved model: done !!!!
----------Epoch18----------
Eproch -1: Val loss 3.6227787424016884  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.620735274420844  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.674953098650332  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.6488906277550592  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 18: Val loss 3.6560385757022433  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 18: Training loss2 2.2766193283928766  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3136063590225067, 0.15903872467224406, 0.0773267599462145, 0.040373167612111446], 'METEOR': 0.08288422781525125, 'ROUGE': 0.2383182957431315, 'CIDEr': 0.08294764743231343}
Test scores {'BLEU': [0.30555128989120645, 0.15168923814827337, 0.07376659060983656, 0.040198021014793264], 'METEOR': 0.08289929124906573, 'ROUGE': 0.23058337224277284, 'CIDEr': 0.09190822659100638}
validation: done !
Switching to RL
