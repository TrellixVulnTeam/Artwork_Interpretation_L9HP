Meshed-Memory Transformer Training
loading files: done!!!
Load vocabulary: done!!
building model: done !!
establish training dataset: done !!
establish evaluation dataset: done !!
-----Training starts-----
----------Epoch0----------
Eproch -1: Val loss 8.133683328275326  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 8.132632697070086  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 5.51966796097932  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 4.807383060455322  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 0: Val loss 4.622108706721553  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 0: Training loss2 4.665660828719904  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3228406246310466, 0.16131105693693043, 0.06632468870252847, 0.029769849739890997], 'METEOR': 0.07922197547648456, 'ROUGE': 0.24286522317330655, 'CIDEr': 0.043451261103433794}
Test scores {'BLEU': [0.31946616430793107, 0.15764612309025783, 0.06767734190864781, 0.03150179754397559], 'METEOR': 0.07871294840169327, 'ROUGE': 0.2396676972842016, 'CIDEr': 0.04976453499100194}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch1----------
Eproch -1: Val loss 4.622108706721553  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 4.620535832864267  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 4.346182858502424  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 4.216088365625452  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 1: Val loss 4.16459537435461  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 1: Training loss2 4.19906156445727  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.307237796599284, 0.1532833860733529, 0.06850378496836229, 0.031220296439448843], 'METEOR': 0.07996390146047772, 'ROUGE': 0.24022730127785757, 'CIDEr': 0.05548255747643067}
Test scores {'BLEU': [0.3041796345953864, 0.14781125658090793, 0.06590677833015596, 0.03259425329604279], 'METEOR': 0.07919408678863682, 'ROUGE': 0.23436719983751847, 'CIDEr': 0.06006458457259502}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch2----------
Eproch -1: Val loss 4.16459537435461  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 4.162909163369073  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 4.08582627331769  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 4.018505776370013  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 2: Val loss 3.991286445547033  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 2: Training loss2 3.979063290627405  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3180672975376807, 0.16795729702518233, 0.08336893189771108, 0.04006480253650634], 'METEOR': 0.08447926760873259, 'ROUGE': 0.24586638612651165, 'CIDEr': 0.07978575098916596}
Test scores {'BLEU': [0.3097684734996063, 0.15916053343777764, 0.07497064363775043, 0.03700601535315436], 'METEOR': 0.08273826920782498, 'ROUGE': 0.2407493562166679, 'CIDEr': 0.07621928375430362}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch3----------
Eproch -1: Val loss 3.991286445547033  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.992014929100319  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.9314123259650335  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.870793007038258  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 3: Val loss 3.8566124086026794  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 3: Training loss2 3.7850896389886675  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3217520067614193, 0.17240981863977153, 0.08546153084324254, 0.04205158932527663], 'METEOR': 0.08639249715539003, 'ROUGE': 0.2477659323527916, 'CIDEr': 0.0842983419296067}
Test scores {'BLEU': [0.3079446075061599, 0.16160658491618785, 0.07869531311112077, 0.04124374207575116], 'METEOR': 0.0822497120832209, 'ROUGE': 0.23860641570283866, 'CIDEr': 0.08292067478902455}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch4----------
Eproch -1: Val loss 3.8566124086026794  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.8553653999611184  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.8210521980568215  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.774762815899319  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 4: Val loss 3.7578767670525446  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 4: Training loss2 3.6044975990130577  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.31725891852316845, 0.1642997880284243, 0.08105906380323503, 0.04247111247577791], 'METEOR': 0.08427586617444166, 'ROUGE': 0.24834259636754505, 'CIDEr': 0.08250490611421503}
Test scores {'BLEU': [0.3118978249309064, 0.16115853307273972, 0.07846746355327643, 0.04239765651789356], 'METEOR': 0.0838163982536703, 'ROUGE': 0.24242065608558183, 'CIDEr': 0.08952048292796397}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch5----------
Eproch -1: Val loss 3.7578767670525446  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.760239080146507  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.731305961255674  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.6920987411781594  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 5: Val loss 3.685059935958297  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 5: Training loss2 3.4261171072108265  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.31873508115520066, 0.16575076613935952, 0.08283952031329869, 0.044715259177857944], 'METEOR': 0.08596312506873141, 'ROUGE': 0.2473301330934406, 'CIDEr': 0.0868149414078122}
Test scores {'BLEU': [0.3129106140064508, 0.16209892668122053, 0.08212698393952986, 0.04705439073927343], 'METEOR': 0.08482478501349026, 'ROUGE': 0.24179140017327339, 'CIDEr': 0.09921269052950558}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch6----------
Eproch -1: Val loss 3.685059935958297  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.683917831491541  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.676960547765096  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.64944088017499  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 6: Val loss 3.6390194627973766  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 6: Training loss2 3.246567391564326  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3250738725530863, 0.16673103812847231, 0.082890959248501, 0.04447131715767512], 'METEOR': 0.08795269301570842, 'ROUGE': 0.24752410945749795, 'CIDEr': 0.09464604826767098}
Test scores {'BLEU': [0.315466135200078, 0.1588161423030964, 0.07931059435173306, 0.04627600177811305], 'METEOR': 0.08472597695350517, 'ROUGE': 0.23936117310807825, 'CIDEr': 0.10372880722119225}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch7----------
Eproch -1: Val loss 3.6390194627973766  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.641000182540328  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.6425727296758583  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.6180318814736827  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 7: Val loss 3.6164680851830378  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 7: Training loss2 3.073198424445258  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.31410088286375515, 0.1633728419982471, 0.08224833838871966, 0.04517552704852317], 'METEOR': 0.08561742556989752, 'ROUGE': 0.24260354864141903, 'CIDEr': 0.09289365409916588}
Test scores {'BLEU': [0.3050295158049665, 0.15496517326489156, 0.07802943869649036, 0.04501623056039777], 'METEOR': 0.08303394100327928, 'ROUGE': 0.23686267454554794, 'CIDEr': 0.09559070741423571}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch8----------
Eproch -1: Val loss 3.6164680851830378  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.6155867046780057  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.63112238601402  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.6065494660977966  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 8: Val loss 3.609191470675998  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 8: Training loss2 2.8961812380410024  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.316699802646126, 0.16102946796805803, 0.07678207838811038, 0.04046071629073465], 'METEOR': 0.08463849234498226, 'ROUGE': 0.2403993473169002, 'CIDEr': 0.08126855887864144}
Test scores {'BLEU': [0.31271006120464423, 0.15542165705562927, 0.07667891544620721, 0.04352915350178731], 'METEOR': 0.08444288880110017, 'ROUGE': 0.23705603804824177, 'CIDEr': 0.08872164281630235}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch9----------
Eproch -1: Val loss 3.609191470675998  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.6099621189965143  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.625333485779939  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.605277997476083  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 9: Val loss 3.5995216369628906  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 9: Training loss2 2.711451226301154  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.31276231800132864, 0.15914813851860926, 0.078821287831305, 0.04261606112130261], 'METEOR': 0.08419974833180806, 'ROUGE': 0.2397709932519548, 'CIDEr': 0.0913368609621243}
Test scores {'BLEU': [0.30313457485349216, 0.14982332022688882, 0.07488177138180294, 0.04373488151173459], 'METEOR': 0.08323191938105565, 'ROUGE': 0.23475851270199338, 'CIDEr': 0.08587503786624538}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch10----------
Eproch -1: Val loss 3.5995216369628906  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.603649457295736  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.647395292917887  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.6159100002712674  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 10: Val loss 3.619117666173864  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 10: Training loss2 2.5246166594234514  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3236786424250029, 0.16621035797294983, 0.08355914186553907, 0.04572039868169815], 'METEOR': 0.08731850970608539, 'ROUGE': 0.24412235833231274, 'CIDEr': 0.092478229195715}
Test scores {'BLEU': [0.3112334920154185, 0.15523951377741668, 0.07910016576933099, 0.04503895024022269], 'METEOR': 0.08413479323419014, 'ROUGE': 0.23497037598933013, 'CIDEr': 0.0950346285443715}
validation: done !
saved model: done !!!!
----------Epoch11----------
Eproch -1: Val loss 3.619117666173864  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.622151498441343  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.6734934471271656  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.648346282817699  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 11: Val loss 3.6364946453659623  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 11: Training loss2 2.342318534360501  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3203678206763389, 0.1622706393374225, 0.07993401847471639, 0.042958620253354084], 'METEOR': 0.08766386908686044, 'ROUGE': 0.24088072380311137, 'CIDEr': 0.10432999785048475}
Test scores {'BLEU': [0.3136397727171599, 0.1539397732792538, 0.07414077612473546, 0.04129592891984856], 'METEOR': 0.08531230505769902, 'ROUGE': 0.23569184859501466, 'CIDEr': 0.09515643902965266}
validation: done !
saved model: done !!!!
----------Epoch12----------
Eproch -1: Val loss 3.6364946453659623  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.6405519202903465  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.7300512260860867  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.684996154573229  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 12: Val loss 3.6664998487189964  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 12: Training loss2 2.1627184640723494  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.32214001161990186, 0.16144077859166578, 0.07915854723466552, 0.04187385287041211], 'METEOR': 0.08489540995588563, 'ROUGE': 0.24056671741198463, 'CIDEr': 0.0881787355292514}
Test scores {'BLEU': [0.31310133603043044, 0.153552917771243, 0.07456135060987139, 0.042422365680723065], 'METEOR': 0.08446232128562489, 'ROUGE': 0.23355387825854562, 'CIDEr': 0.10082804867346877}
validation: done !
saved model: done !!!!
----------Epoch13----------
Eproch -1: Val loss 3.6664998487189964  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.676785363091363  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.731681461687441  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.728655532554344  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 13: Val loss 3.7103628317515054  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 13: Training loss2 2.0021713891147095  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.31084829151845084, 0.1538269259205211, 0.07435431376184319, 0.03980111321314519], 'METEOR': 0.08461217860393332, 'ROUGE': 0.23421106620543286, 'CIDEr': 0.08831414518312289}
Test scores {'BLEU': [0.3017095870446208, 0.1441650904246923, 0.07032731256466737, 0.039046321719393526], 'METEOR': 0.08222837145922787, 'ROUGE': 0.22438646854582237, 'CIDEr': 0.0967136906762575}
validation: done !
saved model: done !!!!
----------Epoch14----------
Eproch -1: Val loss 3.7103628317515054  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!3
training with xe
the 0th iteration: Val loss 3.707698274541784  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 200th iteration: Val loss 3.804449434633608  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
the 400th iteration: Val loss 3.791044659084744  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
Eproch 14: Val loss 3.767848818390458  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!4
Eproch 14: Training loss2 1.813223124776848  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!5
Validation scores {'BLEU': [0.3151617773946966, 0.1570247422009245, 0.07828620336635177, 0.0428504534185359], 'METEOR': 0.08718298056219513, 'ROUGE': 0.23545942565910283, 'CIDEr': 0.10017462043625379}
Test scores {'BLEU': [0.3088661812089995, 0.15311256185170263, 0.07679261608191028, 0.04404149931681498], 'METEOR': 0.08530403516058986, 'ROUGE': 0.2304616827555682, 'CIDEr': 0.10351191156245074}
validation: done !
Switching to RL
