Meshed-Memory Transformer Training
loading files: done!!!
Load vocabulary: done!!
building model: done !!
Establish dataset: done !!
establish evaluation dataset: done !!
-----Training starts-----
----------Epoch0----------
Eproch -1: Val loss 9.940882396697997  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 9.939891719818116  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 9.306884622573852  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 7.768852233886719  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 0: Val loss 6.511788630485535  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 0: Training loss2 6.508415667907052  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.1907516508532909, 0.07414065345511522, 0.026438511276488837, 0.007775300476753329], 'METEOR': 0.046720785592434366, 'ROUGE': 0.1707121228852921, 'CIDEr': 0.024498811870172544}
Test scores {'BLEU': [0.2017646205326539, 0.07879735841696506, 0.031147637338019528, 0.015307213318271033], 'METEOR': 0.04655161112577947, 'ROUGE': 0.16686477744163408, 'CIDEr': 0.025383165893330957}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch1----------
Eproch -1: Val loss 6.511788630485535  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 6.486402297019959  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 5.897607946395874  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 5.586935758590698  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 1: Val loss 5.415382933616638  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 1: Training loss2 5.403115586958069  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.22292746307825892, 0.08911950131540783, 0.03601588937447295, 0.00979594331653287], 'METEOR': 0.05222726768554224, 'ROUGE': 0.18101397050034784, 'CIDEr': 0.030158456974060336}
Test scores {'BLEU': [0.23605087257029317, 0.09314981987887325, 0.036090966489443675, 0.016010770270645205], 'METEOR': 0.05328421368831069, 'ROUGE': 0.17959019116623826, 'CIDEr': 0.029752682749084897}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch2----------
Eproch -1: Val loss 5.415382933616638  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 5.411051917076111  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 5.230750203132629  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 5.090296339988709  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 2: Val loss 4.994597005844116  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 2: Training loss2 4.956720075745514  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3099044900337485, 0.13212218325375605, 0.05138501236496687, 0.016568533463209145], 'METEOR': 0.06649555350043741, 'ROUGE': 0.20592167443415185, 'CIDEr': 0.048583893555541977}
Test scores {'BLEU': [0.3306427037803728, 0.1390736053990677, 0.0503657369951522, 0.01744571808833058], 'METEOR': 0.06769394405784782, 'ROUGE': 0.20724848268698123, 'CIDEr': 0.042493421426948466}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch3----------
Eproch -1: Val loss 4.994597005844116  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.993274402618408  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.892082571983337  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.801612472534179  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 3: Val loss 4.745095109939575  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 3: Training loss2 4.667624929676885  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.33454169099896536, 0.15333575633114196, 0.060425725474472745, 0.02357176347405006], 'METEOR': 0.07790615190849264, 'ROUGE': 0.2237653815158163, 'CIDEr': 0.047638514829253166}
Test scores {'BLEU': [0.3650962087558151, 0.16919611751691285, 0.0685475667093887, 0.030244627965552693], 'METEOR': 0.080038336583174, 'ROUGE': 0.23014010326873505, 'CIDEr': 0.05816852169788953}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch4----------
Eproch -1: Val loss 4.745095109939575  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.744730234146118  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.659885406494141  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.608287620544433  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 4: Val loss 4.581699824333191  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 4: Training loss2 4.457720376443172  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.34512648254309497, 0.16093372555201318, 0.06824711920481373, 0.03241431786099035], 'METEOR': 0.07813193975089963, 'ROUGE': 0.22383963700626278, 'CIDEr': 0.05660197273543357}
Test scores {'BLEU': [0.3621527296696464, 0.17564427306876992, 0.08304587431324652, 0.04209138742073997], 'METEOR': 0.08328332546204555, 'ROUGE': 0.23301445438323312, 'CIDEr': 0.056362617619916774}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch5----------
Eproch -1: Val loss 4.581699824333191  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.582514476776123  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.555438160896301  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.512227416038513  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 5: Val loss 4.49280002117157  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 5: Training loss2 4.317249723102735  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3323063959933354, 0.15291429378482804, 0.06596186958250953, 0.02988770306378341], 'METEOR': 0.07792525214395189, 'ROUGE': 0.22071249016277186, 'CIDEr': 0.04966792445687663}
Test scores {'BLEU': [0.3550913765228888, 0.17327125460421022, 0.08334162645826608, 0.040490255107778136], 'METEOR': 0.08398649419875634, 'ROUGE': 0.2319353152415907, 'CIDEr': 0.0579421687545415}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch6----------
Eproch -1: Val loss 4.49280002117157  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.489256191253662  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.482124304771423  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.445464444160462  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 6: Val loss 4.432461524009705  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 6: Training loss2 4.211142918337947  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.33194366604532083, 0.1526461148144361, 0.06928315873624945, 0.03150663201054305], 'METEOR': 0.08052502935277378, 'ROUGE': 0.22044872055090298, 'CIDEr': 0.05067788066863535}
Test scores {'BLEU': [0.35215015334434685, 0.1696687992434159, 0.08105639870349927, 0.0385211320090674], 'METEOR': 0.08403213889206994, 'ROUGE': 0.22758268529521608, 'CIDEr': 0.05510364374649993}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch7----------
Eproch -1: Val loss 4.432461524009705  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.433366060256958  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.4222749948501585  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.4024189710617065  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 7: Val loss 4.395813655853272  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 7: Training loss2 4.119808355967204  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.32994861986050933, 0.15055267980560139, 0.0642084358736448, 0.027844772403897707], 'METEOR': 0.07773983606872101, 'ROUGE': 0.22106260751563783, 'CIDEr': 0.04883636248055511}
Test scores {'BLEU': [0.35084337513818925, 0.16868285234510622, 0.08037180672362161, 0.03831998122770408], 'METEOR': 0.08329397104868991, 'ROUGE': 0.23155555217870885, 'CIDEr': 0.05519725614584619}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch8----------
Eproch -1: Val loss 4.395813655853272  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.398773574829102  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.385667824745179  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.367239904403687  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 8: Val loss 4.3607865333557125  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 8: Training loss2 4.027127096618432  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.34084078639039594, 0.15851019762923152, 0.06933888181221146, 0.03053475655206457], 'METEOR': 0.0801495471575265, 'ROUGE': 0.22270439838096998, 'CIDEr': 0.06137834715636435}
Test scores {'BLEU': [0.3451004223833331, 0.16507598110778895, 0.0763833085189497, 0.03792425920443657], 'METEOR': 0.08341811952362996, 'ROUGE': 0.2260453613917243, 'CIDEr': 0.0612185056408717}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch9----------
Eproch -1: Val loss 4.3607865333557125  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.359361958503723  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.35409334897995  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.329112088680267  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 9: Val loss 4.324790668487549  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 9: Training loss2 3.9398068068684013  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.34098704475225894, 0.1591479000509786, 0.06973652409072809, 0.030639343495132785], 'METEOR': 0.08099188104933246, 'ROUGE': 0.22214575110360982, 'CIDEr': 0.05944010053098996}
Test scores {'BLEU': [0.34807910291143085, 0.16762988157026304, 0.07892557721359705, 0.03886642231232437], 'METEOR': 0.08420848856432797, 'ROUGE': 0.22651739237749138, 'CIDEr': 0.056254206869945145}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch10----------
Eproch -1: Val loss 4.324790668487549  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.327666783332825  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.325236594676971  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.312678706645966  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 10: Val loss 4.296222555637359  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 10: Training loss2 3.8449449746505073  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3405734809689404, 0.15923957620736973, 0.07170704529675542, 0.03403874593387183], 'METEOR': 0.0823997617448364, 'ROUGE': 0.22485012405143356, 'CIDEr': 0.06358545498021786}
Test scores {'BLEU': [0.3555138216822013, 0.1701542203155971, 0.07829617400242361, 0.03754487334527432], 'METEOR': 0.08399516155449997, 'ROUGE': 0.22975538753499283, 'CIDEr': 0.055629162547196576}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch11----------
Eproch -1: Val loss 4.296222555637359  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.296399009227753  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.295008218288421  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.289545786380768  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 11: Val loss 4.295137667655945  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 11: Training loss2 3.7738590516905854  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3391016542417124, 0.16202027463217758, 0.07480820550591501, 0.03590736453872076], 'METEOR': 0.08070462687840628, 'ROUGE': 0.2241081461245525, 'CIDEr': 0.06479841881604223}
Test scores {'BLEU': [0.3600623359367518, 0.1733232306941811, 0.0808980263962955, 0.04003261945805229], 'METEOR': 0.08555977046263757, 'ROUGE': 0.23183637890934528, 'CIDEr': 0.0628770323802184}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch12----------
Eproch -1: Val loss 4.295137667655945  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.2881123423576355  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.2811949253082275  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.2644216299057005  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 12: Val loss 4.284357953071594  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 12: Training loss2 3.697804319685784  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.33527067468930966, 0.15848526535226976, 0.07153989841435786, 0.034786850519818655], 'METEOR': 0.08210539530487189, 'ROUGE': 0.22459797353566213, 'CIDEr': 0.058892061546035594}
Test scores {'BLEU': [0.35685486334270683, 0.16982727058120575, 0.08053270508631183, 0.03952979013419764], 'METEOR': 0.08688820526540993, 'ROUGE': 0.23136887219029328, 'CIDEr': 0.05903055816816757}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch13----------
Eproch -1: Val loss 4.284357953071594  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.2902637124061584  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.256923937797547  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.252681505680084  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 13: Val loss 4.24474550485611  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 13: Training loss2 3.5892967106639473  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3383819797598358, 0.1642790384326828, 0.07648275498572811, 0.03763508255723739], 'METEOR': 0.08358530125805211, 'ROUGE': 0.22838672817080538, 'CIDEr': 0.07284524670858779}
Test scores {'BLEU': [0.3598045216764539, 0.1758763920865468, 0.086423821389967, 0.04529762289861303], 'METEOR': 0.09012686478850383, 'ROUGE': 0.23466666810578504, 'CIDEr': 0.08215091457576175}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch14----------
Eproch -1: Val loss 4.24474550485611  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.246328353881836  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.267748212814331  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.24444990158081  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 14: Val loss 4.246372759342194  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 14: Training loss2 3.510599348856055  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3444668962214243, 0.16538567593310932, 0.07363599133540721, 0.033442121077702], 'METEOR': 0.08349021055652608, 'ROUGE': 0.2258314038582137, 'CIDEr': 0.06302984369165722}
Test scores {'BLEU': [0.36645754468826613, 0.1772798942215854, 0.08452971090147983, 0.043721035478120764], 'METEOR': 0.0902528437585706, 'ROUGE': 0.23369440122909668, 'CIDEr': 0.07538422738534815}
validation: done !
saved model: done !!!!
----------Epoch15----------
Eproch -1: Val loss 4.246372759342194  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.246394944190979  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.248485279083252  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.2341086030006405  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 15: Val loss 4.244812965393066  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 15: Training loss2 3.430128634839818  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.34001561811915365, 0.1612845855587792, 0.07334444867562491, 0.03510838589948848], 'METEOR': 0.08179186336291262, 'ROUGE': 0.22605934457057011, 'CIDEr': 0.0598395072262431}
Test scores {'BLEU': [0.3647813761172806, 0.17503491253599152, 0.08160207841025245, 0.039522142142776454], 'METEOR': 0.08910300774793863, 'ROUGE': 0.23234325922116536, 'CIDEr': 0.07866271750033631}
validation: done !
saved model: done !!!!
----------Epoch16----------
Eproch -1: Val loss 4.244812965393066  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.238897645473481  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.254771721363068  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.2455321788787845  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 16: Val loss 4.238519775867462  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 16: Training loss2 3.347520135451054  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.34595188070271876, 0.16698754504148694, 0.07734042267134947, 0.0380520931442552], 'METEOR': 0.0827417303304676, 'ROUGE': 0.23069883865691226, 'CIDEr': 0.06571621291923516}
Test scores {'BLEU': [0.3571219785818325, 0.1729238662848263, 0.08114473348595287, 0.04133632188246764], 'METEOR': 0.08832097256322982, 'ROUGE': 0.23001524679216293, 'CIDEr': 0.0716275670014022}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch17----------
Eproch -1: Val loss 4.238519775867462  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.243260252475738  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.247811281681061  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.2456502437591555  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 17: Val loss 4.227798867225647  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 17: Training loss2 3.2452145555745  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3454663490964597, 0.16901169659055462, 0.08202238885811565, 0.043097406403109745], 'METEOR': 0.0840137237456178, 'ROUGE': 0.22679910623510013, 'CIDEr': 0.06689226672454378}
Test scores {'BLEU': [0.36201339168772845, 0.17499797979700651, 0.08240186976636314, 0.04340453265333242], 'METEOR': 0.09007721197106977, 'ROUGE': 0.22972337786293348, 'CIDEr': 0.08441765058421583}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch18----------
Eproch -1: Val loss 4.227798867225647  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.2320465564727785  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.245631313323974  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.248062610626221  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 18: Val loss 4.2437671542167665  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 18: Training loss2 3.1653344648471777  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.34230045081346383, 0.16142432154126496, 0.07197033282483525, 0.0344837094153472], 'METEOR': 0.08414998621552536, 'ROUGE': 0.22737570839202226, 'CIDEr': 0.06387265836301456}
Test scores {'BLEU': [0.3609881069135, 0.17902517899338843, 0.09118977721377369, 0.050181107544762536], 'METEOR': 0.09133971685517936, 'ROUGE': 0.23398104425547456, 'CIDEr': 0.09330209254997349}
validation: done !
saved model: done !!!!
----------Epoch19----------
Eproch -1: Val loss 4.2437671542167665  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.2360145330429075  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.257503724098205  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.250506949424744  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 19: Val loss 4.246412777900696  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 19: Training loss2 3.078233271405317  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3436312174996195, 0.1663580836496082, 0.0774179359789004, 0.037618108064187875], 'METEOR': 0.08569169876172905, 'ROUGE': 0.22870569232220786, 'CIDEr': 0.07390111488903739}
Test scores {'BLEU': [0.35539637666443585, 0.17106055596242725, 0.08078285919568358, 0.0401850087413267], 'METEOR': 0.08903324254052333, 'ROUGE': 0.22742536864617968, 'CIDEr': 0.0709704220738972}
validation: done !
saved model: done !!!!
----------Epoch20----------
Eproch -1: Val loss 4.246412777900696  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.244258642196655  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.274432706832886  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.266121506690979  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 20: Val loss 4.253953266143799  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 20: Training loss2 2.981456649476203  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3490094460980182, 0.17161057920303702, 0.07897981167441905, 0.03935962288542504], 'METEOR': 0.08512316443323609, 'ROUGE': 0.23176054334812193, 'CIDEr': 0.064267825592348}
Test scores {'BLEU': [0.3624902328400582, 0.17939471378580715, 0.08804904752602728, 0.04756338108776662], 'METEOR': 0.09037981765226875, 'ROUGE': 0.23577278317658745, 'CIDEr': 0.09150235456463263}
validation: done !
saved model: done !!!!
----------Epoch21----------
Eproch -1: Val loss 4.253953266143799  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.253090238571167  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.267915225028991  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.2698141694068905  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 21: Val loss 4.279618871212006  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 21: Training loss2 2.9044827602911685  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3389516466129953, 0.16261517982651882, 0.07260258833570334, 0.03346035363300106], 'METEOR': 0.0824708615775548, 'ROUGE': 0.22471097447472702, 'CIDEr': 0.06261723083848622}
Test scores {'BLEU': [0.35190387127390876, 0.1705273905238809, 0.08018639491252656, 0.04032560764384563], 'METEOR': 0.08779685336810099, 'ROUGE': 0.22760615894326294, 'CIDEr': 0.07618203688181646}
validation: done !
saved model: done !!!!
----------Epoch22----------
Eproch -1: Val loss 4.279618871212006  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.2860307693481445  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.288204777240753  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.297285926342011  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 22: Val loss 4.299505627155304  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 22: Training loss2 2.8103336216746895  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.34223092972787983, 0.16297971597205668, 0.07348662807403242, 0.03418874021848304], 'METEOR': 0.08412368276508071, 'ROUGE': 0.22751643567971377, 'CIDEr': 0.06691759402668351}
Test scores {'BLEU': [0.3564143319015705, 0.1706462455193333, 0.07996571849854825, 0.04056461091765585], 'METEOR': 0.08823739998968924, 'ROUGE': 0.22834224401199785, 'CIDEr': 0.06864094015127407}
validation: done !
Switching to RL
