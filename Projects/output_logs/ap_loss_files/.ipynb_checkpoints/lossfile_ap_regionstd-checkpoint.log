Meshed-Memory Transformer Training
loading files: done!!!
Load vocabulary: done!!
building model: done !!
Establish dataset: done !!
establish evaluation dataset: done !!
-----Training starts-----
----------Epoch0----------
Eproch -1: Val loss 12.289917469024658  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 12.28844337463379  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 11.340728902816773  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 9.07022213935852  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 0: Val loss 7.235199713706971  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 0: Training loss2 7.258869188419287  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.19843221894191745, 0.06719573337116921, 0.016927659973197885, 9.893938130080366e-07], 'METEOR': 0.0395589010886561, 'ROUGE': 0.16002152880821535, 'CIDEr': 0.009592516660003245}
Test scores {'BLEU': [0.21528665400026964, 0.07911553329439573, 0.02684096259992517, 0.010385633867170811], 'METEOR': 0.0413737390623779, 'ROUGE': 0.16500163740764603, 'CIDEr': 0.010267140359321707}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch1----------
Eproch -1: Val loss 7.235199713706971  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 7.199197721481323  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 6.3169138669967655  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 5.821075654029846  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 1: Val loss 5.576331162452698  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 1: Training loss2 5.562419939732206  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.2772891448181861, 0.10553023895799638, 0.033131685037113064, 0.009043932158004243], 'METEOR': 0.05394133472766601, 'ROUGE': 0.18926387954849141, 'CIDEr': 0.016264373709091753}
Test scores {'BLEU': [0.2869750987021855, 0.11148204176957488, 0.04118738537220799, 0.01662918148699875], 'METEOR': 0.05533570718904947, 'ROUGE': 0.1918432468215045, 'CIDEr': 0.016282167234631165}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch2----------
Eproch -1: Val loss 5.576331162452698  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 5.570641875267029  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 5.334413814544678  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 5.144772839546204  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 2: Val loss 5.0345137357711796  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 2: Training loss2 4.980234622955322  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.332787352637431, 0.13432992591910375, 0.04699547021977255, 0.01640435389613998], 'METEOR': 0.0698099940332141, 'ROUGE': 0.21657931204487887, 'CIDEr': 0.030329445184673592}
Test scores {'BLEU': [0.3490386864310453, 0.1459059896418886, 0.0524837292121742, 0.018766699828072515], 'METEOR': 0.06990163047890678, 'ROUGE': 0.21870049267326588, 'CIDEr': 0.027155189412700006}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch3----------
Eproch -1: Val loss 5.0345137357711796  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 5.032769083976746  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.911200928688049  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.808139991760254  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 3: Val loss 4.755926537513733  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 3: Training loss2 4.66029283274775  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3503995827865598, 0.1646601558843174, 0.06413576146613056, 0.026574103696642464], 'METEOR': 0.08036815710831549, 'ROUGE': 0.23178370926397132, 'CIDEr': 0.034712867656796334}
Test scores {'BLEU': [0.3563426161755198, 0.17138064910793277, 0.07534529370573245, 0.0317435192571052], 'METEOR': 0.080757473886737, 'ROUGE': 0.23357633202274808, 'CIDEr': 0.04017537312944467}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch4----------
Eproch -1: Val loss 4.755926537513733  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.756508827209473  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.701285076141358  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.655252575874329  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 4: Val loss 4.6318378210067745  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 4: Training loss2 4.493322400079257  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.34484622158171613, 0.16622489802121354, 0.06952736370056854, 0.031008324726305377], 'METEOR': 0.07964839681259926, 'ROUGE': 0.23340069318375245, 'CIDEr': 0.037796807898557674}
Test scores {'BLEU': [0.3556527945491642, 0.1702795004468287, 0.06916837542310847, 0.02740427512322488], 'METEOR': 0.08405171298330587, 'ROUGE': 0.23291865342970347, 'CIDEr': 0.04045506207832878}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch5----------
Eproch -1: Val loss 4.6318378210067745  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.631291937828064  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.605353450775146  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.579523921012878  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 5: Val loss 4.566150045394897  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 5: Training loss2 4.384637652963832  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.34011906878376647, 0.16029486101083393, 0.06665583960634806, 0.028534388547462954], 'METEOR': 0.07879897100665963, 'ROUGE': 0.2275782524352026, 'CIDEr': 0.041255061952268225}
Test scores {'BLEU': [0.3481954303963325, 0.16413160564247298, 0.07065034405690591, 0.03135830945061428], 'METEOR': 0.0812470322958392, 'ROUGE': 0.2258847349458665, 'CIDEr': 0.03734907268028774}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch6----------
Eproch -1: Val loss 4.566150045394897  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.562833690643311  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.543321704864502  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.522624468803405  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 6: Val loss 4.507074785232544  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 6: Training loss2 4.276646755743718  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3341322709091188, 0.15035506146618638, 0.06319303411657944, 0.02940368962830035], 'METEOR': 0.07795914158462573, 'ROUGE': 0.22161532730971692, 'CIDEr': 0.04009834213239348}
Test scores {'BLEU': [0.33502123842292236, 0.1525701244886065, 0.06700563262983456, 0.03060195148478393], 'METEOR': 0.08024598004044046, 'ROUGE': 0.22190180698545003, 'CIDEr': 0.035761692340609434}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch7----------
Eproch -1: Val loss 4.507074785232544  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.508012127876282  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.487314677238464  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.4672668933868405  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 7: Val loss 4.458173537254334  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 7: Training loss2 4.177695136139358  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.32911297698012815, 0.15591428876384436, 0.06833947523406314, 0.0337505398138596], 'METEOR': 0.0788923177185997, 'ROUGE': 0.22084579163445886, 'CIDEr': 0.03979849604760643}
Test scores {'BLEU': [0.3390778945862644, 0.1654220036812408, 0.07050454416587197, 0.03240005540887033], 'METEOR': 0.08266376942469024, 'ROUGE': 0.22552080083491416, 'CIDEr': 0.03675980844348066}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch8----------
Eproch -1: Val loss 4.458173537254334  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.4560974597930905  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.452585506439209  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.430779504776001  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 8: Val loss 4.41961190700531  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 8: Training loss2 4.088436556899029  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3271430692324629, 0.15331393738369936, 0.06771762276071666, 0.03271235126186624], 'METEOR': 0.07924523733919714, 'ROUGE': 0.22266010348496418, 'CIDEr': 0.0413884241049434}
Test scores {'BLEU': [0.3418925643640994, 0.16644613468857355, 0.07326246205151013, 0.03499585690590864], 'METEOR': 0.08407263403959055, 'ROUGE': 0.22564776555573668, 'CIDEr': 0.04034836943940362}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch9----------
Eproch -1: Val loss 4.41961190700531  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.4204939842224125  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.403309655189514  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.392657589912415  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 9: Val loss 4.377655172348023  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 9: Training loss2 3.9827808660009634  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3157968978720808, 0.14213126698504727, 0.06253614377776187, 0.030481430988588392], 'METEOR': 0.07815558645302645, 'ROUGE': 0.21691119844420134, 'CIDEr': 0.04435471743682191}
Test scores {'BLEU': [0.3335546214094493, 0.15631699973757524, 0.07156984393692657, 0.03595793234742306], 'METEOR': 0.08203783806331091, 'ROUGE': 0.22009422580346705, 'CIDEr': 0.04574752078566333}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch10----------
Eproch -1: Val loss 4.377655172348023  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.378259825706482  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.381552994251251  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.356183803081512  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 10: Val loss 4.35293470621109  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 10: Training loss2 3.893026339835015  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.31900841395874685, 0.14574028391019925, 0.06200554460181819, 0.02973714618095168], 'METEOR': 0.07820841039972126, 'ROUGE': 0.21643499411881678, 'CIDEr': 0.04307675065265075}
Test scores {'BLEU': [0.33346346518823516, 0.1592738834867933, 0.0725515455286577, 0.03647946310936385], 'METEOR': 0.08155396262900406, 'ROUGE': 0.22048352867662652, 'CIDEr': 0.03996974420973099}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch11----------
Eproch -1: Val loss 4.35293470621109  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.351126384735108  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.346318423748016  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.3444484829902645  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 11: Val loss 4.331531429290772  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 11: Training loss2 3.8040625375250112  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3148660349672861, 0.14290203262131712, 0.06114163723034064, 0.02912055406866081], 'METEOR': 0.07624576190443183, 'ROUGE': 0.212951638237802, 'CIDEr': 0.04020692348811911}
Test scores {'BLEU': [0.3243903960362223, 0.15196527773486712, 0.06997801074474282, 0.03590144872949176], 'METEOR': 0.07979813769101538, 'ROUGE': 0.21529422672118098, 'CIDEr': 0.04404977209406241}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch12----------
Eproch -1: Val loss 4.331531429290772  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.330796468257904  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.329992198944092  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.324275767803192  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 12: Val loss 4.32354326248169  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 12: Training loss2 3.722134609153305  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3126885807264077, 0.1442054390224873, 0.06490292618233974, 0.0320024282388328], 'METEOR': 0.07823190380135943, 'ROUGE': 0.21224849775557836, 'CIDEr': 0.046777531257274386}
Test scores {'BLEU': [0.3252702762000751, 0.15495567216842263, 0.07235419816045933, 0.03644752745282425], 'METEOR': 0.07996379707974022, 'ROUGE': 0.2155138341495115, 'CIDEr': 0.047737525191539086}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch13----------
Eproch -1: Val loss 4.32354326248169  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.324834334850311  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.312028861045837  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.2977132320404055  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 13: Val loss 4.294100892543793  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 13: Training loss2 3.6126382005387456  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3205908988692616, 0.14930651379516036, 0.06684109301415515, 0.03148895939468817], 'METEOR': 0.0790443398571539, 'ROUGE': 0.21767437915661508, 'CIDEr': 0.045565686944737435}
Test scores {'BLEU': [0.33375037086675735, 0.15931036768178708, 0.0759673723720086, 0.037732278917865125], 'METEOR': 0.08153356921356468, 'ROUGE': 0.22038482591265673, 'CIDEr': 0.052107724053087015}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch14----------
Eproch -1: Val loss 4.294100892543793  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.293606519699097  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.2904508233070375  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.283286845684051  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 14: Val loss 4.278209531307221  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 14: Training loss2 3.513295431067978  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3224855085147801, 0.14998290596745828, 0.06892134647665171, 0.035510462918697895], 'METEOR': 0.07920771604285332, 'ROUGE': 0.21722411358253205, 'CIDEr': 0.05088555868584437}
Test scores {'BLEU': [0.33145606011452505, 0.15865324332862432, 0.07029405977847246, 0.033763363575636134], 'METEOR': 0.08313667115989003, 'ROUGE': 0.2186960726295965, 'CIDEr': 0.053918101915518275}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch15----------
Eproch -1: Val loss 4.278209531307221  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.275489938259125  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.284087550640106  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.274573755264282  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 15: Val loss 4.283216726779938  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 15: Training loss2 3.4287884425425874  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.32174536591719033, 0.15171299055716223, 0.07124686961909589, 0.03673204295172543], 'METEOR': 0.08018263406340402, 'ROUGE': 0.2197428858184912, 'CIDEr': 0.05391789402439638}
Test scores {'BLEU': [0.33741229997136474, 0.15745103922279335, 0.07120113382372993, 0.03416366242656657], 'METEOR': 0.08196947809282339, 'ROUGE': 0.21758296624832835, 'CIDEr': 0.06125181360821112}
validation: done !
saved model: done !!!!
----------Epoch16----------
Eproch -1: Val loss 4.283216726779938  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.283903014659882  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.2858821749687195  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.291194951534271  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 16: Val loss 4.278271317481995  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 16: Training loss2 3.3303352922633076  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3315934565765151, 0.15546860192796305, 0.07221036000286273, 0.03774824737245847], 'METEOR': 0.08160238527472326, 'ROUGE': 0.22312420172630004, 'CIDEr': 0.052893907755588575}
Test scores {'BLEU': [0.3420022332044646, 0.16296194259532096, 0.07593436482540118, 0.03737941288809129], 'METEOR': 0.08256124415617574, 'ROUGE': 0.2229393188273938, 'CIDEr': 0.056175122199964386}
validation: done !
saved model: done !!!!
----------Epoch17----------
Eproch -1: Val loss 4.278271317481995  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.2820592045784  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.280353951454162  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.275216412544251  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 17: Val loss 4.2714443564414974  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 17: Training loss2 3.224331855773926  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3272397840918651, 0.14504152720151775, 0.0609853737141317, 0.027708610333941428], 'METEOR': 0.07968596288922743, 'ROUGE': 0.216859169858072, 'CIDEr': 0.050949244136174986}
Test scores {'BLEU': [0.33371795247170943, 0.15761846241713176, 0.07185717110044607, 0.03310101342775185], 'METEOR': 0.08320607069392956, 'ROUGE': 0.22028913774749376, 'CIDEr': 0.057944515408255085}
validation: done !
-----reach better loss-----
saved model: done !!!!
----------Epoch18----------
Eproch -1: Val loss 4.2714443564414974  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.273088073730468  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.293648695945739  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.282489466667175  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 18: Val loss 4.285027432441711  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 18: Training loss2 3.1353711356287417  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.32823411876267516, 0.15010227989968639, 0.06884200912253897, 0.03478346171249087], 'METEOR': 0.08185488131212652, 'ROUGE': 0.21899814944958626, 'CIDEr': 0.05177771453693209}
Test scores {'BLEU': [0.33424039197666633, 0.1573974498919942, 0.06891931781231063, 0.03210512655443263], 'METEOR': 0.08310395614377342, 'ROUGE': 0.22193515018779816, 'CIDEr': 0.055155597979120084}
validation: done !
saved model: done !!!!
----------Epoch19----------
Eproch -1: Val loss 4.285027432441711  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.2867490410804745  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.294551742076874  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.304522001743317  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 19: Val loss 4.293159830570221  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 19: Training loss2 3.0420321208843286  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.32538214407398974, 0.14909218672997782, 0.06831917671994739, 0.03355701693997152], 'METEOR': 0.07909301211080112, 'ROUGE': 0.21673064357378038, 'CIDEr': 0.053848663057907885}
Test scores {'BLEU': [0.33430745142070223, 0.15837763041956432, 0.07315011371442372, 0.03567448394128436], 'METEOR': 0.08143335650394351, 'ROUGE': 0.2166767295215731, 'CIDEr': 0.05428330554317156}
validation: done !
saved model: done !!!!
----------Epoch20----------
Eproch -1: Val loss 4.293159830570221  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.291861176490784  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.3093148350715635  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.300784850120545  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 20: Val loss 4.304021966457367  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 20: Training loss2 2.946498884670976  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3289504515657775, 0.14897657953926996, 0.06495358896154663, 0.029932220728722064], 'METEOR': 0.07974852276475296, 'ROUGE': 0.21851743062454912, 'CIDEr': 0.04991699107600855}
Test scores {'BLEU': [0.3457273923803977, 0.1610346608401695, 0.07360289203667632, 0.03720935435978212], 'METEOR': 0.08365953441289428, 'ROUGE': 0.22414959815131474, 'CIDEr': 0.06094805209696035}
validation: done !
saved model: done !!!!
----------Epoch21----------
Eproch -1: Val loss 4.304021966457367  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.3039936304092405  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.3040701985359195  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.315200102329254  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 21: Val loss 4.31329699754715  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 21: Training loss2 2.8329761788464976  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.3318582969266301, 0.15416496620543693, 0.0704037346717104, 0.03394822845874297], 'METEOR': 0.08333271294966349, 'ROUGE': 0.22263824584199884, 'CIDEr': 0.06222730645117329}
Test scores {'BLEU': [0.33691820589200977, 0.1596257955405159, 0.07233918476405378, 0.03637207219286806], 'METEOR': 0.08266602587755435, 'ROUGE': 0.22311167145078512, 'CIDEr': 0.061682092399634354}
validation: done !
saved model: done !!!!
----------Epoch22----------
Eproch -1: Val loss 4.31329699754715  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
training with xe
the 0th iteration: Val loss 4.313542759418487  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 50th iteration: Val loss 4.326411163806915  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
the 100th iteration: Val loss 4.333632183074951  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 22: Val loss 4.3300821542739865  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Eproch 22: Training loss2 2.742036871288134  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Validation scores {'BLEU': [0.33606117681883807, 0.15615438315253669, 0.06891894282708494, 0.032949144218375095], 'METEOR': 0.08334113811382587, 'ROUGE': 0.22816221796380404, 'CIDEr': 0.04748128922085128}
Test scores {'BLEU': [0.34944265193519114, 0.1701509233180738, 0.07844282044015188, 0.03927037027190851], 'METEOR': 0.08501094828922587, 'ROUGE': 0.2277515276040113, 'CIDEr': 0.07031242512015035}
validation: done !
Switching to RL
